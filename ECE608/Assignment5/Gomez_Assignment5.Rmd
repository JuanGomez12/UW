---
title: "Assignment 4"
output: html_notebook
---

ECE 608 (Spring 2019) Assignment 5
Professor: Jason Au
Student: Juan Manuel Gomez Gonzalez


Information: 
Regression


First, the required libraries need to be loaded:
```{r Libraries load, results='hide'}
library(tidyverse)
library(grid)
library(gridExtra)
library(datasets)
library(QuantPsyc)
library(Hmisc)
library(lawstat)
library(lmtest)
library(car)
library(olsrr)
```


# 1. For the following research questions, identify the correct regression you would need to use (and subtype of linear regression, if applicable) and identify the independent and dependent variables, as well as whether they are continuous or categorical values: (4 marks) 
## a. Joseph would like to know what demographic factors (i.e., sex, age, race) are related to colorectal tumor diameter in cancer patients.
The regression would be a linear regression, specifically a Statistical Multiple regression. The dependent variable would be the tumor diameter (continous), while the independent variables would be the demographic factors that will be tested for the relation. In this case, sex and race would be categorical while ahe would be a continuous variable.

## b) Priya is interested in determining whether the number of drivers pulled over for speeding is impacted by the day of the week in Ontario.
The appropriate regression for this scenario would be a Poisson Regression. The number of drivers pulled over for speeding would be the (numerical, non-nontinous) dependent variable, and the  day of the week would be the (categorical) independent variable.

## c) Josie would like to investigate whether consideration of sleep duration improves the prediction of academic grades above and beyond the duration of studying hours.
The regression depicted in this scenario would be a linear regression, specifically a hierarchical multiple regression. The independent variables would be the sleep duration and the studying hours, both being continous variables. The dependent variable would be the academic grades, and depending on the system can be a continuous (if is from 0 to 100%) or categorical (from F to A+).

## d) Kevin would like to be able to predict whether older adults will snore or not based on their age group (50s, 60s or 70s), gender, and type of pillow (soft or hard).
Logistical Regression




# 3. For the following research question, run the appropriate linear regression model. Report whether the model meets ALL assumptions of linear regression. (7 marks)
Using the dataset airquality from library(datasets), investigate which of Solar.R, Wind and Temp are the best predictors of Ozone quality. 
 
More information about the dataset: Ozone recordings were taken on different days, along with the amount of solar radiation, wind speed, and air temperature (measured in degrees Fahrenheit).

```{r}
df <- airquality
df
```

```{r DataFrame preprocessing}
df <- na.omit(df)
df
```

```{r}
mod <- lm(Ozone ~ Solar.R + Wind + Temp, data = df)
writeLines("---------------- Model Summary ----------------")
summary(mod)
writeLines("---------------- Standardized betas ----------------")
QuantPsyc::lm.beta(mod)
```

```{r}
both <- ols_step_both_p(mod, pent = 0.3, prem = 0.5, details = TRUE) #pent 0.3, prem 0.3
plot(both)
```


```{r}
#Hierarchical Multiple Regression (Blockwise)
hmod0 <- lm(Ozone ~ 1, data = df)
hmod1 <- lm(Ozone ~ Solar.R, data = df)
hmod2 <- lm(Ozone ~ Solar.R + Wind, data = df)
hmod3 <- lm(Ozone ~ Solar.R + Wind + Temp, data = df)

stats::anova(hmod0,hmod1,hmod2,hmod3)

summary(hmod3)
```
 

 